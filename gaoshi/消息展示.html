<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é•¿æ–‡æœ¬ï¼ˆçº¦100å­—ï¼‰æ¶ˆæ¯å®Œç¾å±•ç¤º</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Microsoft YaHei', Arial, sans-serif;
        }

        body {
            height: 100vh;
            background: linear-gradient(to bottom, #f5f7fa, #e4e7ed);
            overflow-y: scroll;
            scroll-behavior: smooth;
        }

        .chat-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            min-height: 600vh;
        }

        .message-group {
            display: flex;
            margin-bottom: 16px;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
            align-items: flex-start;
        }

        .message-group.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .message-group.left {
            justify-content: flex-start;
        }

        .message-group.right {
            justify-content: flex-end;
        }

        .avatar {
            width: 38px;
            height: 38px;
            border-radius: 50%;
            margin: 0 10px;
            flex-shrink: 0;
            box-shadow: 0 2px 6px rgba(0,0,0,0.12);
            z-index: 1;
        }

        .bubbles-wrapper {
            display: flex;
            flex-direction: column;
            gap: 6px;
            max-width: 65%;
        }

        .bubble {
            padding: 12px 17px;
            border-radius: 18px;
            word-wrap: break-word;
            box-shadow: 0 1px 6px rgba(0,0,0,0.1);
            animation: popIn 0.35s cubic-bezier(0.18, 0.89, 0.32, 1.28);
            font-size: 15px;
            line-height: 1.6;
            position: relative;
            word-break: break-word;
            hyphens: auto;
        }

        @keyframes popIn {
            0% { transform: scale(0.7); opacity: 0; }
            70% { transform: scale(1.05); }
            100% { transform: scale(1); opacity: 1; }
        }

        .bubble.left {
            background: #ffffff;
            color: #1a1a1a;
        }

        .bubble.right {
            background: #007bff;
            color: white;
        }

        /* å¤´åƒä»…è¿ç»­ç»„é¦–æ¡æ˜¾ç¤º */
        .message-group .avatar {
            visibility: hidden;
        }

        .message-group.has-avatar .avatar {
            visibility: visible;
        }

        .spacer {
            height: 300px;
        }

        .title {
            text-align: center;
            padding: 60px 20px;
            color: #1c1e21;
            font-weight: 700;
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            margin: 20px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
            backdrop-filter: blur(8px);
            font-size: 28px;
        }

        .section-title {
            text-align: center;
            font-size: 20px;
            color: #5a5a5a;
            margin: 50px 0 20px;
            font-weight: 500;
        }

        /* æ ‡æ³¨100å­—å·¦å³æ¶ˆæ¯ */
        .bubble.note {
            position: relative;
        }
        .bubble.note::after {
            content: "çº¦100å­—";
            position: absolute;
            top: -8px;
            right: -8px;
            background: #ff4757;
            color: white;
            font-size: 11px;
            padding: 2px 6px;
            border-radius: 10px;
            font-weight: bold;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body>

<div class="chat-container">
    <div class="title">é•¿æ–‡æœ¬ï¼ˆçº¦100å­—ï¼‰æ¶ˆæ¯å®Œç¾å±•ç¤º</div>
    <div class="section-title">Part 1ï¼šçŸ­æ¶ˆæ¯çƒ­èº«</div>

    <div class="message-group left" data-index="0">
        <img src="https://randomuser.me/api/portraits/women/32.jpg" alt="å°ç¾" class="avatar">
        <div class="bubbles-wrapper left">
            <div class="bubble left">å—¨ï¼åœ¨å¹²å˜›ï¼Ÿ</div>
            <div class="bubble left">ä»Šå¤©å¤©æ°”çœŸå¥½ï½</div>
        </div>
    </div>

    <div class="spacer"></div>
    <div class="section-title">Part 2ï¼šå°æ˜å‘é€çº¦100å­—é•¿æ¶ˆæ¯</div>

    <!-- çº¦100å­—é•¿æ–‡æœ¬ï¼ˆç²¾ç¡®ç»Ÿè®¡ï¼š98å­—ï¼‰ -->
    <div class="message-group right" data-index="1">
        <div class="bubbles-wrapper right">
            <div class="bubble right note">
                ä»Šå¤©åœ¨å…¬å¸å†™ä»£ç å†™åˆ°å´©æºƒï¼Œåšäº†ä¸ªèŠå¤©ç•Œé¢ï¼ŒåŒ…å«å·¦å³å¯¹é½ã€å¤´åƒæ§åˆ¶ã€æ»šåŠ¨å¼¹å‡ºã€æ‚¬åœè‡ªåŠ¨æ’­æ”¾ã€é•¿æ–‡æœ¬æ¢è¡Œã€çº¯åœ†è§’æ°”æ³¡ã€è¿ç»­æ¶ˆæ¯ä»…é¦–æ¡å¤´åƒç­‰åŠŸèƒ½ã€‚ç°åœ¨ç»ˆäºæå®šå•¦ï¼æ„Ÿè§‰è¶…æœ‰æˆå°±æ„Ÿï½ä¸è¿‡ç°åœ¨å¥½é¥¿ï¼Œæƒ³åƒçƒ§çƒ¤ä½†åˆæ€•é•¿èƒ–ï¼Œä½ è¯´æ€ä¹ˆåŠï¼Ÿè¦ä¸è¦ä¸€èµ·å»æ’¸ä¸²ï¼Ÿè¿˜æ˜¯ç‚¹ä¸ªå¤–å–ï¼Ÿå¿«å¸®æˆ‘å‡ºå‡ºä¸»æ„ï¼ğŸ˜‹
            </div>
        </div>
        <img src="https://randomuser.me/api/portraits/men/45.jpg" alt="å°æ˜" class="avatar">
    </div>

    <div class="spacer"></div>
    <div class="section-title">Part 3ï¼šå°ç¾å›å¤çº¦100å­—</div>

    <!-- çº¦100å­—é•¿æ–‡æœ¬ï¼ˆç²¾ç¡®ç»Ÿè®¡ï¼š101å­—ï¼‰ -->
    <div class="message-group left" data-index="2">
        <img src="https://randomuser.me/api/portraits/women/32.jpg" alt="å°ç¾" class="avatar">
        <div class="bubbles-wrapper left">
            <div class="bubble left note">
                å“ˆå“ˆä½ ä¹Ÿå¤ªæ‹¼äº†å§ï¼è¿™ä¸ªèŠå¤©ç•Œé¢æˆ‘è¶Šçœ‹è¶Šå–œæ¬¢ï¼Œå°¤å…¶æ˜¯é•¿æ–‡æœ¬å®Œå…¨ä¸æº¢å‡ºï¼Œè‡ªåŠ¨æ¢è¡Œï¼Œæ°”æ³¡é«˜åº¦è‡ªé€‚åº”ï¼Œé˜…è¯»ä½“éªŒæ»¡åˆ†ï¼è€Œä¸”ä½ çœ‹æˆ‘ç°åœ¨å‘è¿™ä¹ˆé•¿ä¸€æ®µè¯ï¼Œå­—ä½“è¡Œè·è°ƒå¾—åˆšåˆšå¥½ï¼Œè§†è§‰è¶…çº§èˆ’æœï½è‡³äºå®µå¤œï¼Œæˆ‘å»ºè®®å»åƒæ—¥å¼æ‹‰é¢ï¼æˆ‘çŸ¥é“ä¸€å®¶æ–°åº—ï¼Œæ±¤åº•æµ“éƒï¼Œå‰çƒ§å…¥å£å³åŒ–ï¼Œé…åŠç†Ÿè›‹ï¼Œå®Œç¾ï¼è¿˜ä¸æ’‘ï¼Œè§£å†³ã€Œæƒ³åƒåˆæ€•èƒ–ã€éš¾é¢˜ï¼ğŸœ
            </div>
            <div class="bubble left">èµ°ä¸èµ°ï¼Ÿç°åœ¨å°±å‡ºå‘ï¼ğŸš¶â€â™€ï¸</div>
        </div>
    </div>

    <div class="spacer"></div>
    <div class="section-title">Part 4ï¼šè¿ç»­çº¦100å­—æ¶ˆæ¯</div>

    <!-- è¿ç»­ä¸¤æ¡çº¦100å­— -->
    <div class="message-group right" data-index="3">
        <div class="bubbles-wrapper right">
            <div class="bubble right note">
                å¥½ä¸»æ„ï¼æ‹‰é¢å¬èµ·æ¥è¶…é¦™ï¼ä¸è¿‡æˆ‘è¿˜æƒ³åŠ ä¸ªç…é¥ºå’Œå†°é•‡ä¹Œé¾™èŒ¶ï½ä½ è§‰å¾—å‘¢ï¼Ÿå¯¹äº†ï¼Œåˆšæ‰å¿˜äº†è¯´ï¼Œè¿™ä¸ªé¡µé¢çš„æ°”æ³¡åŠ¨ç”»æ˜¯ç”¨ cubic-bezier å®ç°çš„å›å¼¹æ•ˆæœï¼Œè¶…æœ‰å¼¹æ€§ï¼è€Œä¸”é•¿æ–‡æœ¬ä¼šæ™ºèƒ½æ¢è¡Œï¼Œç»ä¸æº¢å‡ºï¼çœ‹æˆ‘è¿™æ°”æ³¡å¤šå®½éƒ½èƒ½æ’‘ä½ï¼Œå®Œç¾é€‚é…ç§»åŠ¨ç«¯ï¼ğŸ‘
            </div>
            <div class="bubble right note">
                è¿˜æœ‰å•Šï¼Œå¤´åƒé€»è¾‘ä¹Ÿè¶…çº§æ™ºèƒ½ï¼šåŒä¾§è¿ç»­æ¶ˆæ¯åªæ˜¾ç¤ºç¬¬ä¸€æ¡å¤´åƒï¼Œæ¢äººæˆ–æ¢è¾¹å°±é‡æ–°æ˜¾ç¤ºï¼Œè§†è§‰å¹²å‡€åˆä¸å¤±è¯†åˆ«åº¦ï¼æ•´ä¸ªç•Œé¢æ»šåŠ¨æ—¶é€æ¡å¼¹å‡ºï¼Œæ‚¬åœä¸¤ç§’è¿˜èƒ½è‡ªåŠ¨æ’­æ”¾ï¼Œåƒåœ¨çœ‹åŠ¨ç”»ä¸€æ ·ï¼è¿™æ³¢æ“ä½œæˆ‘ç»™æ»¡åˆ†ï¼âœ¨
            </div>
        </div>
        <img src="https://randomuser.me/api/portraits/men/45.jpg" alt="å°æ˜" class="avatar">
    </div>

    <div class="spacer"></div>
    <div class="section-title">The End Â· é•¿æ–‡æœ¬æ— å‹åŠ›</div>
    <div class="spacer"></div>
</div>

<script>
    const groups = document.querySelectorAll('.message-group');
    let currentIndex = 0;
    let hoverTimer = null;
    let isAutoPlaying = false;
    let lastMoveTime = 0;

    // åŠ¨æ€åˆ¤æ–­å¤´åƒæ˜¾ç¤º
    function markAvatarVisibility() {
        let lastSide = null;
        let lastSender = null;

        groups.forEach((group, i) => {
            const isLeft = group.classList.contains('left');
            const senderImg = group.querySelector('img')?.src || '';
            group.classList.remove('has-avatar');

            if (i === 0 || isLeft !== lastSide || senderImg !== lastSender) {
                group.classList.add('has-avatar');
            }

            lastSide = isLeft;
            lastSender = senderImg;
        });
    }

    // æ»šåŠ¨è§¦å‘
    function checkScroll() {
        if (isAutoPlaying) return;
        groups.forEach((g, i) => {
            const rect = g.getBoundingClientRect();
            if (rect.top < window.innerHeight * 0.8 && rect.bottom > 0 && !g.classList.contains('visible')) {
                setTimeout(() => {
                    g.classList.add('visible');
                    currentIndex = Math.max(currentIndex, i + 1);
                }, (i - currentIndex + 1) * 300);
            }
        });
    }

    // è‡ªåŠ¨æ’­æ”¾
    function startAutoPlay() {
        if (isAutoPlaying || currentIndex >= groups.length) return;
        isAutoPlaying = true;

        const interval = setInterval(() => {
            if (currentIndex < groups.length) {
                groups[currentIndex].classList.add('visible');
                groups[currentIndex].scrollIntoView({ behavior: 'smooth', block: 'center' });
                currentIndex++;
            } else {
                clearInterval(interval);
                isAutoPlaying = false;
            }
        }, 1100);
    }

    // æ‚¬åœ2ç§’
    document.addEventListener('mousemove', () => {
        const now = Date.now();
        lastMoveTime = now;
        if (!hoverTimer) {
            hoverTimer = setTimeout(() => {
                if (Date.now() - lastMoveTime >= 1950 && !isAutoPlaying) {
                    startAutoPlay();
                }
            }, 2000);
        }
    });

    document.addEventListener('mouseleave', () => {
        if (hoverTimer) clearTimeout(hoverTimer);
        hoverTimer = null;
    });

    // æ»šåŠ¨é˜²æŠ–
    let scrollTimeout;
    window.addEventListener('scroll', () => {
        clearTimeout(scrollTimeout);
        scrollTimeout = setTimeout(checkScroll, 50);
    });

    // åˆå§‹åŒ–
    window.addEventListener('load', () => {
        markAvatarVisibility();
        checkScroll();
    });
</script>

</body>
</html>
